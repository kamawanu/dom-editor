#! /usr/bin/env python
# vi: set syntax=python : */

# Ugly hack to stop wierd chars appearing...
import xml.dom.html
xml.dom.html.HTML_CHARACTER_ENTITIES = {}

from gtk import *
import sys
from os.path import dirname

from Window import Window

app_dir = dirname(sys.argv[0])

window = GtkWindow()
window.set_title("Dome")
window.set_default_size(400, 300)

tl_windows = 0

def tl_ref(w = None):
	global tl_windows
	tl_windows = tl_windows + 1

def tl_unref(w = None):
	global tl_windows
	tl_windows = tl_windows - 1
	if tl_windows < 1:
		mainquit()

docs = []

if len(sys.argv) > 1:
	for file in sys.argv[1:]:
		win = Window(file)
		win.connect('destroy', tl_unref)
		tl_ref()
		win.show()
else:
	win = Window()
	win.connect('destroy', tl_unref)
	tl_ref()
	win.show()

if tl_windows > 0:
	#import profile
	#profile.run('mainloop()')

	mainloop()
